<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<title>8월 PS Note - 2</title>
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>8월 PS Note - 2 | Programming Notes</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="8월 PS Note - 2" />
<meta name="author" content="Jeong Deokin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Summary(solved.ac 난이도) 참 어려운 문제: D4 Live Programming: D4 Laser Cutter: D5 Water Bottle: D5 이상적인 도시: D1 히스토그램에서 가장 큰 직사각형과 쿼리: D3" />
<meta property="og:description" content="Summary(solved.ac 난이도) 참 어려운 문제: D4 Live Programming: D4 Laser Cutter: D5 Water Bottle: D5 이상적인 도시: D1 히스토그램에서 가장 큰 직사각형과 쿼리: D3" />
<link rel="canonical" href="http://localhost:4000/posts/8%EC%9B%94-PS-Note-2/" />
<meta property="og:url" content="http://localhost:4000/posts/8%EC%9B%94-PS-Note-2/" />
<meta property="og:site_name" content="Programming Notes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-25T00:00:00+09:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/posts/8%EC%9B%94-PS-Note-2/","headline":"8월 PS Note - 2","dateModified":"2020-08-25T00:00:00+09:00","datePublished":"2020-08-25T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/8%EC%9B%94-PS-Note-2/"},"author":{"@type":"Person","name":"Jeong Deokin"},"description":"Summary(solved.ac 난이도) 참 어려운 문제: D4 Live Programming: D4 Laser Cutter: D5 Water Bottle: D5 이상적인 도시: D1 히스토그램에서 가장 큰 직사각형과 쿼리: D3","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		TeX: {
		  equationNumbers: {
			autoNumber: "AMS"
		  }
		},
		tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
	  }
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		  alert("Math Processing Error: "+message[1]);
		});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		  alert("Math Processing Error: "+message[1]);
		});
</script>
<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
  
</head>
<body>
  <header class="texture-black">
    <div class="container"><div class="navbar">
	<ul>
		<a href="/"><li>Home</li></a>
		<a href="/about/"><li>About</li></a>
	</ul>
</div></div><div class="container">
	<h1>8월 PS Note - 2</h1>
	<h4 class="post-description"></h4>
	<div class="post-date" style="margin-top:20px">
		Published on Aug 25, 2020
	</div>
	<ul class="post-tags"></ul>
</div>
</header>
  <main>
    <div class="container">
      <div class="post-container">
          <h3 id="summarysolvedac-난이도">Summary(solved.ac 난이도)</h3>
<ul>
  <li>참 어려운 문제: D4</li>
  <li>Live Programming: D4</li>
  <li>Laser Cutter: D5</li>
  <li>Water Bottle: D5</li>
  <li>이상적인 도시: D1</li>
  <li>히스토그램에서 가장 큰 직사각형과 쿼리: D3</li>
</ul>

<hr />

<h3 id="boj-18189---참-어려운-문제"><a href="https://www.acmicpc.net/problem/18189">BOJ 18189 - 참 어려운 문제</a></h3>
<p>정점 $u$와 $v$가 연결되어 있을 때, $u$와 $v$ 중 $u$와 더 가까운 서브트리를 $T_u$, $v$와 더 가까운 서브트리를 $T_v$라 하자. 이때 두 정점의 색깔을 $A_u, A_v$라 한다면, $T_u$에 $A_u$의 색깔을 가진 정점이 있다면 $T_v$의 정점은 루트가 될 수 없다. 마찬가지로 $T_v$에 $A_v$의 색깔을 가진 정점이 있다면 $T_u$의 정점은 루트가 될 수 없다. 각 서브트리에 주어진 색깔을 가진 정점이 있는지는 Euler tour와 이진 탐색으로 알 수 있고, 루트가 될 수 없음을 체크해주는 것도 Euler tour와 BIT로 처리할 수 있다. 전체 시간복잡도는 $O(N\log{N})$.</p>

<h3 id="boj-16813---live-programming"><a href="https://www.acmicpc.net/problem/16813">BOJ 16813 - Live Programming</a></h3>
<p>우선 주어진 상황에서는 곡의 순서가 정해지지 않았기 때문에, 순서를 정해줘야 할 필요가 있다. 바로 이어서 스케쥴되는 두 노래의 $f$값의 차의 제곱이 점수에서 빼지므로, 이러한 값을 최소화하는 것이 이득임을 알 수 있다. 따라서 $f$값을 오름차순으로 정렬하면, 주어진 노래를 앞에서부터 순서대로 스케쥴하는 것이 최적임을 알 수 있다.</p>

<p>이제 다음과 같은 DP를 생각하자.</p>

<p>$dp(i, j):=i$번 노래가 마지막으로 스케쥴되었고, 전체 노래 길이가 $j$일 때의 최대 만족도</p>

<p>이를 naive하게 구해준다면, 모든 $k&lt;i$에 대해 $dp(k, j-t_i)-(f_i-f_j)^2$의 최댓값을 구해 갱신해야 한다. 이는 제한에 비해 너무 느리므로, 다른 방법을 생각해야 한다. 다행이도 식을 정리하면, CHT를 적용할 수 있는 꼴이 되는 것을 알 수 있다. 이를 이용해 CHT 자료구조(?)를 총 $N$개 만들어서 풀어주면 된다. 나는 Li Chao Tree를 이용해 각 항마다 $O(\log{N})$에 구해줬는데, $x$좌표와 기울기가 단조증가하므로 각 항마다 $O(1)$에도 값을 구할 수 있을 것 같다. Li Chao Tree를 쓰면 $O(NT\log{N})$, deque를 쓰면 $O(NT)$에 해결할 수 있다.</p>

<h3 id="boj-16812---laser-cutter"><a href="https://www.acmicpc.net/problem/16812">BOJ 16812 - Laser Cutter</a></h3>
<p>TSP같이 생긴 문제에 제한을 $N\leq300$ 정도로 줘서 말도 안 되는 문제라고 생각했는데, 몇 가지 관찰로 문제를 신기하게 변형할 수 있었다. 문제에서 요구하는 최적해는, 주어진 선분의 길이는 무조건 이동하고, 전원을 끈 상태로 움직이는 거리를 최소화한 상태이다. 이때 모든 선분 쌍마다 거리를 가중치로 하여 끝점-&gt;시작점 의 간선을 추가하면, 최대한 작은 가중치를 이용해 모든 선분이 연결되도록 해야 하는 문제로 바뀌는 것을 알 수 있다. 이는 가중치 있는 이분 매칭 문제이며, MCMF 또는 Hungarian Method로 해결할 수 있음이 알려져 있다. 시간 제한이 넉넉하지만, 실제로는 완전 이분그래프(?)의 모양이기 때문에 MCMF는 TLE를 받고, Hungarian은 매우 빠르게 작동한다.</p>

<h3 id="boj-17733---water-bottle"><a href="https://www.acmicpc.net/problem/17733">BOJ 17733 - Water Bottle</a></h3>
<p>비슷한 문제를 그래프에서 풀면 어떻게 될까? 그럴 경우 가중치가 작은 간선을 우선적으로 사용하여 움직여서 목표 지점까지 도달하는 것이 최선임을 알 수 있고, 이는 결국 MST를 구하는 것과 동치이다. 이를 이 문제에 그대로 적용할 수 있는데, 먼저 BFS를 이용해 각 건물끼리의 거리를 계산해주자. 이는 <a href="https://www.acmicpc.net/problem/14868">KOI 2017 문명</a> 문제와 비슷하게 해줄 수 있다.</p>

<p>위의 BFS를 이용하면 MST를 이룰 수 있는 간선의 후보를 구할 수 있는데, 이를 이용해 MST를 실제로 구성하자. 남은 작업은 쿼리로 들어오는 두 건물에 대해 LCA를 찾아주면서 최대 거리를 구해주면 끝. 그래프가 여러 개의 컴포넌트로 이루어질 수 있으니 처리에 유의해야 한다.</p>

<h3 id="boj-5813---이상적인-도시"><a href="https://www.acmicpc.net/problem/5813">BOJ 5813 - 이상적인 도시</a></h3>
<p>Naive하게 세어 주는 방법 외엔 생각하기 힘든 문제다. 문제에서 주어지는 지도가 상당히 특이한데, 해당 조건에서의 핵심적인 관찰이 풀이를 이끌어낸다.</p>

<p>각 셀을 같은 $x$좌표를 가지면서 $y$좌표가 인접하게 묶어주자. 그렇게 해서 $x$좌표가 인접한 것들을 모두 이어주면, 해당 그래프는 놀랍게도 트리가 됨을 알 수 있다. 수식으로 증명은 못하겠으나, 실제로 몇 개의 경우를 그리면 조건에 의해 모두 트리가 됨을 알 수 있다. 이제 트리에서 모든 노드 쌍 간의 거리 합을 구하면, 실제로 모든 셀 쌍의 $x$성분 거리 합을 구하는 것과 같다. 트리에서 모든 노드 쌍 거리 합을 구하는 방법은 DP, centroid decomposition 등의 여러 방법이 있는데, DP를 이용해주면 매우 쉽게 구할 수 있다.</p>

<p>위 방법을 $y$에 대해서도 한 번 더 수행해주면 문제를 해결할 수 있다. 격자의 셀이 저러한 조건을 만족한다는 사실로부터 엄청난 성질을 이끌어 풀이를 내는 것이 매우 감명 깊은 문제였다.</p>

<h3 id="boj-16977---히스토그램에서-가장-큰-직사각형과-쿼리"><a href="https://www.acmicpc.net/problem/16977">BOJ 16977 - 히스토그램에서 가장 큰 직사각형과 쿼리</a></h3>
<p>$[l, r]$ 구간이 주어지면, 길이가 $w$인 구간의 최솟값의 최댓값을 구하는 문제이다. 최소의 최대, 혹은 그 반대의 키워드가 등장하면 이분 탐색으로 해결할 수 있다는 의심을 해볼 수 있고, 실제로도 맞다. 이 경우에는 쿼리가 매우 많이 주어지니 병렬 이분 탐색으로 접근해볼 수 있다.</p>

<p>어떤 자료구조 A에 큰 원소부터 차례로 넣을 것이다. 이때 어떤 쿼리의 답이 $x$임을 판별하고자 할 때, 이는 $x$보다 크거나 같은 원소를 모두 A에 넣고 A에서 $[l, r]$ 구간에 길이 $w$인 구간이 있음을 확인하는 것과 같게 된다. 이를 충분히 빠르게 할 수 있다면 병렬 이분 탐색으로 문제를 해결할 수 있을 것이다.</p>

<p>이를 구현하는 방법으로 자료구조 A를 최대 구간 연속합을 구하는 세그먼트 트리로 정하면 된다. 초기에 모든 원소를 -INF로 설정하고, 원소를 넣을 때마다 해당하는 위치에 1을 업데이트시키면, 구간 쿼리가 들어왔을 때 그 구간의 최대 구간합이 $w$를 넘는지 확인해주면 된다. 이러한 방식을 이용하면 전체 시간복잡도 $O(N\log^2{N})$에 문제를 해결할 수 있다.</p>

<hr />

      </div>

        <!-- Configure Disqus --></div>
  </main><footer class="texture-black">
  <div class="container">
  <h3> 
    &copy;
    2020
    Programming Notes.
  </h3>
</div>
</footer>
</body>
</html>